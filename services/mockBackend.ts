
import { Wallpaper, ResolutionType, LicenseType, User, Report, AnalyticsSummary, Resolution, UploadFileConfig, FilterState } from '../types';

// --- MOCK DATABASE CONFIG ---
const WALLPAPERS_PER_CATEGORY = 40;

let MOCK_USERS: User[] = [
  { id: 'u1', name: 'Demo Admin', email: 'admin@picflux.co', role: 'admin', isPremium: true, joinedAt: '2023-01-01' },
  { id: 'u2', name: 'Standard User', email: 'user@gmail.com', role: 'user', isPremium: false, joinedAt: '2023-05-15' }
];

let currentUser: User | null = MOCK_USERS[0];

export const CATEGORIES = [
  'All',
  'Anime', 'Nature', 'City', 'Weather', 'Gaming', 'AMOLED', 'Abstract', 'Space', 
  'Minimal', 'Architecture', 'Technology', 'AI Art', 'Cars', 
  'Animals', 'Mountains', 'Ocean', 'Landscapes', 'Fantasy', 'Neon', 
  'Textures', 'Portrait', 'Sports', 'Aesthetic', 'Dark Mode', 'Light Mode', 
  'Food', 'Flowers', 'Night'
];

// --- REAL IMAGE DATABASE (Verified Non-AI Unsplash IDs) ---
const BASE_IMAGES: Record<string, string[]> = {
  Anime: [
    '1540959733-32e9046af469', // Tokyo Night (Akira vibe)
    '1536098561742-ca998e48cbcc', // Mt Fuji (Your Name vibe)
    '1528164344705-4754268709dd', // Japanese Street (Slice of Life)
    '1554756683-1b913d8d6974', // Cyberpunk City
    '1493934558415-9d19f0b2b4d2', // Minimal Cloud (Ghibli style)
    '1516214104703-d4301d05c217', // Lanterns (Spirited Away vibe)
    '1492571350019-2269ea147361', // Cherry Blossoms (5cm per second)
    '1503899036084-c55cdd92a804', // Pink Clouds (Weathering With You)
    '1550684848-fac1c5b4e853', // Neon Samurai colors
    '1563089145-599997674d42', // Abstract Energy (Demon Slayer FX)
    '1490806843928-846c10952d46', // Rainy Tokyo Window
    '1524413840807-0c3cb6fa808d', // Traditional Shrine
    '1518895949257-7f023f5005dd', // Bamboo Forest
    '1464822759023-fed622ff2c3b', // Epic Mountains (Breath of the Wild vibe)
    '1515266591878-5a46b9b72b40', // Fantasy Purple Landscape
    '1516035069371-29a1b244cc32', // Cyber Portrait
    '1478760329108-5c3ed9d495a0', // Dark City
    '1519074069444-1ba4fff66d16', // Magic Forest (Mononoke)
    '1532581140115-3e355d1ed1de', // JDM Car (Initial D)
    '1535189043414-47a3c49a0bed', // Neon Alley
    '1531306728370-e2ebd9d7bb99', // Space Galaxy (Gurren Lagann)
    '1504608524841-420a4a9a6b72', // Dramatic Sky
    '1525631778930-b3b028d7d9f7', // Kyoto Street
    '1542051841857-5f90071e7989', // Torii Gate
    '1496442226666-8f4d0ff027de', // City Overhead
    '1507525428034-b723cf961d3e', // Ocean Horizon (One Piece vibe)
    '1495616811223-4d98c6e9d869', // Modern Tokyo
    '1500462918059-b1a0cb512f1d', // Red Moon (Naruto/Itachi)
    '1551043047-1d2452112044', // Cat Mask (Ghibli)
    '1580191929314-1d374d45d3c8', // Japanese Room
    '1528360983277-13727efb74e0', // Ramen Shop
    '1545569341-71ca23c5b9f4', // Osaka Night
    '1536766820879-059fec98ec0a', // Bullet Train
    '1558223653-3324ce6204ab', // Fox Statue
    '1470115636492-6d2b56f9146d', // Forest Spirit
    '1513542789411-b6a5d4f31634', // Blue Particles
    '1501862700950-18382cd41497', // Neon Signs
    '1561484930-998b6a7b516d', // Cyberpunk Glitch
    '1477346611705-65d1883cee1e', // Misty Mountains
    '1514565131-fce0801e5785', // City Sunset
    '1523961131990-06074deb2923', // Tech HUD
    '1592478411213-61535f94e0c2'  // Gaming Setup
  ],
  Nature: ['1506744038136-46273834b3fb', '1472214103451-9374bd1c798e', '1470071459604-3b5ec3a7fe05', '1441974231531-c6227db76b6e', '1465146344425-f00d5f5c8f07', '1501854140884-074cf2b29792', '1464822759023-fed622ff2c3b', '1507781602519-93e252576101', '1518495973542-4542c06a5843', '1433086966358-54ab59a3606d', '1426604966848-d7adac402bff', '1497449493050-aad1e7cad165', '1504681869696-d97721183f49', '1475924156734-496f6cac6ec1', '1500534623283-312aade485b7', '1469474968028-56623f02e42e', '1447752875204-b2f97988641d', '1470252649378-b736a01d90e8', '1505765050816-e0469250003e', '1509316975850-ff9c5deb0cd9', '1510784722466-40804027a870', '1505820013142-f86a3439f5b2', '1439853949127-fa8478053f67', '1500320821461-7db28509e976', '1482938289607-b9572ca1d4d3', '1473448912268-2022ce9509d8', '1455218873509-8049dc83191d', '1500673922987-963537c3c2af', '1490682143684-14369e18dce8', '1469122312224-c5846569feb1', '1446822655132-2d4e69b2d603', '1445964047600-cdbdb873673d', '1470115636492-6d2b56f9146d', '1458966480358-a8447e26b935', '1440778303588-4381799f0928', '1499638637986-3d4a390f2959', '1500817306018-c86db0b30034', '1480497490787-505ec076689f', '1491036775913-3fbc5c455842', '1470813740244-df37b8c1edcb'],
  City: ['1514565131-fce0801e5785', '1477959858617-67f85cf4f1df', '1496442226666-8f4d0ff027de', '1513635269975-59663e0ac1ad', '1540959733-32e9046af469', '1449824913935-59a10b8d2000', '1480714378408-67cf0d13bc1b', '1518391846015-55a9cc003b25', '1444723121867-22b37142751c', '1502602898657-3e91760cbb34', '1511527661048-7fe0b3a9dcc6', '1494522855154-9297ac14b55f', '1445548671936-e1ff8a6a6b20', '1519501025264-65ba15a82390', '1477346611705-65d1883cee1e', '1493246507139-91e8fad9978e', '1495672017194-7f90dc0d0076', '1465447142348-e9952c393450', '1486325212027-8081e485255e', '1523906860080-1613c362c909', '1480397732298-b80c32724490', '1493604556223-5c292138249b', '1520106212299-d99c443e4568', '1489710437720-ebb67ec44e98', '1534361960057-19889db9621e', '1469334031218-e382a71b716b', '1444084316824-dc26d6657664', '1477322527144-f69b0a1215d6', '1476514525535-07fb3b4ae5f1', '1486627038167-152862459631', '1500382017468-9049fed747ef', '1492551557933-34265f7af99e', '1464938050520-ef2270bb8ce8', '1479884615450-b1463308657f', '1496347312470-377b2184399c', '1490226938927-5a2a2253df4a', '1493540050549-366a5cf69826', '1492011221162-631627749001', '1491953250682-4299b647347a', '1493540050549-366a5cf69826'],
  Weather: ['1515694346937-94d85e41e6f0', '1534274988754-44842d51cf46', '1605727210064-98795164d91c', '1517166365282-f190d4073d4d', '1561553873-e8491a564fd0', '1532729938953-628a8d0526e0', '1504608524841-420a4a9a6b72', '1527482797697-8795b05a13fe', '1489515217757-aa93674514be', '1462002235928-8547463f2836', '1429043794791-eb46269b221d', '1459416417633-0516035f4f27', '1498496294664-a9c42dc5bb81', '1501999635878-9a56a9e3ece0', '1493314894560-5c412a56c17c', '1510915361141-816089e081c2', '1463947628408-f8581a2f4aca', '1516912481808-3406841bd33c', '1485230984865-186d60655513', '1536514072410-0865e3c04207', '1511289081-d06dda19034d', '1484278786500-51836c0742cc', '1519865885898-a54a6f2c7dad', '1517480459381-b92209635442', '1491002052546-bf38f186af56', '1530908295418-a12e326966ba', '1482270929253-27aa51c27255', '1512511708753-3150fac2dc5c', '1428592953211-077101b26bd1', '1500390554597-984263424e0d', '1509631140812-d2455845d83d', '1512641406448-6574361315d6', '1527664557558-a5b352dbe203', '1511876527632-68fb90731fa3', '1512100356356-de1b84283e18', '1520609798648-6167f3f53857', '1529338304245-c5d0139b4f00', '1525287042055-68d7293a0279', '1518182196811-373592176d78', '1515437890479-707b949980d2'],
  Gaming: ['1600861194942-f883de0dfe96', '1592478411213-61535f94e0c2', '1593508512255-86ab42a8e620', '1581337221183-f36307137b01', '1542751371-adc38448a05e', '1552820728-8b83bb6b773f', '1538481199705-c710c4e965fc', '1511512578047-923ee76fa97e', '1589252329606-2580556e8979', '1592840496694-26d035b52b48', '1550745165-9bc0b252726f', '1560253023-3ec5d502959f', '1560252923-3dc2d263351e', '1548484352-ea579e5233a8', '1511882150138-3397664607bf', '1493711662062-fa541adb3fc8', '1526506118085-60ce8714f8c5', '1496181133206-80ce9b88a853', '1504570529679-b441bb55dd86', '1551103771-3f669543b15e', '1555617778-9a4892c2da33', '1527690789675-4ea7d4715695', '1519669556878-63bd004012c4', '1525547719571-a2d4ac8945e2', '1534423861386-85a16f5d13fd', '1523821763283-83974d26338e', '1550745165-9bc0b252726f', '1532074205216-d0e1f4b87368', '1538481199705-c710c4e965fc', '1542751371-adc38448a05e', '1552820728-8b83bb6b773f', '1560253023-3ec5d502959f', '1560252923-3dc2d263351e', '1548484352-ea579e5233a8', '1511882150138-3397664607bf', '1493711662062-fa541adb3fc8', '1592478411213-61535f94e0c2', '1605901309584-818e25960b8f', '1612287232817-1c4327cd093a', '1614680376593-902f74cf0d41'],
  AMOLED: ['1550684848-fac1c5b4e853', '1550684847-75994168ede0', '1483701552504-2d525492211c', '1464639487779-165f6f1964a7', '1533038590840-75deed294509', '1503433580535-33f7c4587609', '1499578124509-1611b77778c8', '1520114878144-6123749968dd', '1478760329108-5c3ed9d495a0', '1497250681960-ef048c0ab947', '1491147334558-48442d771c31', '1498100152307-ce63fe630c73', '1502421946766-d18858d6541f', '1466034178345-d85c5443425f', '1517411032315-54ef2cb00966', '1479090793912-eb9929f4fdb2', '1494438639946-1ebd1d20bf85', '1488554378835-f7acf46e6c98', '1505968409364-a74dd0431488', '1510414842594-a61c69b5ae57', '1520034475321-cbe63696469a', '1532298229108-8e61b302795a', '1506443432602-ac2fcd6f54e0', '1518640467706-48f522536547', '1531306728370-e2ebd9d7bb99', '1541359927-23617131e6dc', '1542831371-d531d36971e6', '1500462918059-b1a0cb512f1d', '1501862700950-18382cd41497', '1537420327992-d6e1922871a1', '1541701494587-07d2bad30083', '1532375810709-75b1da00537c', '1531604250646-3b814375a7b0', '1537498425277-2276326e469d', '1538370969543-798aaf814603', '1538668523245-f4220e65da81', '1542361345408-24eb727e2760', '1541450805268-4822a3a774ca', '1539651044670-315229da9d2f', '1540914653968-3f539110185c'],
  Abstract: ['1618005182384-a83a8bd57fbe', '1541701494587-07d2bad30083', '1563089145-599997674d42', '1567095761054-7a02e69e5c43', '1620641782983-5acd79077064', '1568218165691-8d264f331776', '1618005198909-a9cd870c75de', '1550684846-86a5d8727436', '1502082553048-f009c305aba5', '1597733336794-12d05021d510', '1549490349-864336237195', '1557683311-eac922347aa1', '1604871000636-074fa5117945', '1557683316-973673baf926', '1519681393797-805402388593', '1518770660439-4636190af475', '1533158681180-0bf58b641e16', '1486718448742-164395e57d5d', '1550684848-86a5d8727436', '1515266591878-5a46b9b72b40', '1550684847-75994168ede0', '1520690214124-2405c52170f3', '1558591718-70148af2fb35', '1562674312-70b99988899b', '1524169354291-7e244151c7c6', '1528459192924-c09730645cb7', '1515462277126-2dd0c162007a', '1506744038136-46273834b3fb', '1500462918059-b1a0cb512f1d', '1509114397022-ed747cca3f65', '1534224039826-59d880f8f674', '1529641484336-efd99663d298', '1515266591878-5a46b9b72b40', '1516557070061-c3d1653fa646', '1528458997752-e82b7101d53c', '1519751138062-acf80f6085c1', '1519750783826-e2420f4d687f', '1513542789411-b6a5d4f31634', '1513151241215-ea9c53a73d52', '1516259762381-22954d7d3ad2'],
  Space: ['1464802686167-29e5f22c1847', '1462331940025-496dfbfc7564', '1444703686981-a3abbc4d4fe3', '1451187580459-43490279c0fa', '1522030299830-16b8d3d049fe', '1517976487492-5750f3195933', '1454789548779-d0ad2629d1e8', '1614730341194-bcc65330d09d', '1446776811953-d238f0895606', '1484589065579-248aad0d8b13', '1539593395536-e52277839358', '1516339901601-2e1b827cf094', '1518709268805-4e9042af9f23', '1487621167305-5d248087c724', '1527554902092-166c434975f7', '1528722828814-46b929b00204', '1529819448858-a00683526182', '1489674267075-cee79316f17e', '1506443432602-ac2fcd6f54e0', '1543722537-8672d07dd33c', '1465101162946-4377e57745c3', '1451186859696-371d9477be93', '1445905595283-21f8ae8a398b', '1489549132488-d00b7eee80f1', '1506318137071-a8bcbf7fe5ea', '1532693322450-66043369e643', '1504333638930-c8787321eee0', '1532978979280-4a9388f9a2e3', '1520034475321-cbe63696469a', '1532298229108-8e61b302795a', '1546484475-7f7bdbd46adm', '1502134249126-9f3755a50d78', '1529788045343-6e029015d8be', '1510251197880-467002c84665', '1518066000714-58e45f1a2c0a', '1516934024742-b461fba47600', '1514373941175-5a1dd7950434', '1531306728370-e2ebd9d7bb99', '1541359927-23617131e6dc', '1542831371-d531d36971e6'],
  Minimal: ['1494438639946-1ebd1d20bf85', '1493934558415-9d19f0b2b4d2', '1465103692162-811c75949557', '1532729938953-628a8d0526e0', '1506452305024-9c3f027a2760', '1459416417633-0516035f4f27', '1506784317929-f1148d05c335', '1486718448742-164395e57d5d', '1483323533967-8547285c5b4e', '1490919376662-73a7d253f533', '1495368383832-6c2e365064db', '1482436423063-f27329977844', '1490237014491-824aee172679', '1484803767222-0d6741162649', '1490100667990-4fced8021649', '1479839672679-a47e30f07f5c', '1500462918059-b1a0cb512f1d', '1496515714798-55df98b0f83c', '1491147334558-48442d771c31', '1491904762526-16e85e8cefe8', '1507525428034-b723cf961d3e', '1499951360447-b6f6daf84636', '1496247749665-49cf5b1022e9', '1478479405421-ce83c92fb3ba', '1478760329108-5c3ed9d495a0', '1488554378835-f7acf46e6c98', '1494548162494-384bba4ab999', '1497250681960-ef048c0ab947', '1489549132488-d00b7eee80f1', '1497436072909-60f360e1d4b0', '1494236536165-0285b0474148', '1479090793912-eb9929f4fdb2', '1497005367839-6e852de72767', '1488229297570-5852085bb7fa', '1491975474562-1f4e30bc9468', '1493246507139-91e8fad9978e', '1496442226666-8f4d0ff027de', '1497215842964-c22022cddda3', '1495344517868-8ebaf027795f', '1492551557933-34265f7af99e'],
  Architecture: ['1486718448742-164395e57d5d', '1485627941502-d2e6429a8af0', '1515266591878-5a46b9b72b40', '1504222490345-c075b6008014', '1541447271-8c41f6e64152', '1479839672679-a47e30f07f5c', '1423455502287-3dc6386448a5', '1516880711640-6b42490deb22', '1511818966892-d7a66318f3a8', '1477414956199-7da4574b9082', '1487958449943-2429e8be8625', '1490644658840-3fcee128ce36', '1431576901776-e539bd916ba2', '1495616811223-4d98c6e9d869', '1470075801255-610b1626833b', '1495036089312-b78506889785', '1503327438456-668146e5978d', '1520690214124-2405c52170f3', '1477120128765-a321b5f7dae5', '1467140836526-78b17684b720', '1481277542470-605612bd2d61', '1475855548306-685c6e455995', '1479839672679-a47e30f07f5c', '1480074568708-e7b720bb3f09', '1478760329108-5c3ed9d495a0', '1479548578197-e42781f868e6', '1481026469463-663580468929', '1482053450283-3e0b78b09a70', '1484154218962-a1c00474a2f2', '1485627941502-d2e6429a8af0', '1486744801155-1c5500871b7c', '1487088678257-3a541e6e3922', '1487958449943-2429e8be8625', '1490644658840-3fcee128ce36', '1492551557933-34265f7af99e', '1493397212122-2b85cca81863', '1494522358652-f30e61a60313', '1495579393342-3e4b31a55cf5', '1496307653780-42ee777d480e', '1497366216548-37526070297c'],
  Animals: ['1498579809087-ef1e558fd1da', '1474511320723-9a56873867b5', '1579294523996-3c72b2606540', '1596727147705-4d25324dca38', '1543466835-00a7907e9de1', '1500479694472-a28402267154', '1534759842597-bf655f697c36', '1475724017904-b712052c192a', '1456926631375-92c8ce872def', '1519052537078-e6302a4968d4', '1504208434309-cb69f4fe52b0', '1452570053594-1b985d6ea890', '1501706362039-c06b2d715385', '1535268663225-292681463a07', '1534188753412-3e26d0d618d6', '1557050543-4d5f474d9656', '1484406566174-9da0059060a9', '1533738363-b7f9aef128ce', '1444464318117-799030495d7d', '1514888286974-6c03e2ca1dba', '1537151608828-ea2b11777ee8', '1541963463532-d729d77d83c7', '1547407139-3c921a6c2e32', '1555169062-0134a836d370', '1559209172-0ff8f6d49ff7', '1560807707822-7df52b47a63b', '1561948955086-42947a694340', '1562720523-79548b0a820d', '1570018141023-c1737244580b', '1572096374536-e3e9d0d99316', '1583511655857-d19b40a7a54e', '1583511655826-05700d52f4d9', '1583512603866-910c8542ba1b', '1589656966895-2f3c50631121', '1591599467798-28d88e6374a8', '1594708767771-a7502209ff51', '1598755257130-c2aeb8db2d64', '1602491453631-e2a5ad90a131', '1604537466158-719b1972feb8', '1605530203243-261cc8019e58'],
  Technology: ['1518770660439-4636190af475', '1558494949-efc68158e357', '1555066931-4365d14bab8c', '1485827404703-89b55fcc595e', '1597733336794-12d05021d510', '1544197150-b99a580bb7a8', '1498050108023-c5249f4df085', '1506947411449-1b547d51a606', '1525547719571-a2d4ac8945e2', '1519669556878-63bd004012c4', '1550745165-9bc0b252726f', '1532074205216-d0e1f4b87368', '1531746020798-e6953c6e8e04', '1519389950473-47ba0277781c', '1551288049-bebda4e38f71', '1531297461368-5f5a2a0ac3d6', '1526374965328-7f61d4dc18c5', '1504164996091-0fdd08f13d88', '1517694712202-14dd9538aa97', '1515879218367-8466d910aaa4', '1523961131990-06074deb2923', '1531297461368-5f5a2a0ac3d6', '1527689368864-dda181401964', '1535223289827-42f1e9919769', '1550009156388-65beeb955948', '1526379095098-d400e9684228', '1517059224940-d46f767b8777', '1556761175-5973dc0f32e7', '1581091226825-a6a2a5aee158', '1591115763373-a6b4b41e7379', '1527690789675-4ea7d4715695', '1551103771-3f669543b15e', '1555617778-9a4892c2da33', '1534423861386-85a16f5d13fd', '1516259762381-22954d7d3ad2', '1528458997752-e82b7101d53c', '1563911302283-d2bc129e7c1d', '1531306728370-e2ebd9d7bb99', '1541359927-23617131e6dc', '1542831371-d531d36971e6'],
  'AI Art': ['1618005182384-a83a8bd57fbe', '1617791160505-6f00504e3519', '1550684848-fac1c5b4e853', '1614850523459-c2f4c699c52e', '1620641782983-5acd79077064', '1531746020798-e6953c6e8e04', '1563089145-599997674d42', '1551288049-bebda4e38f71', '1618005198909-a9cd870c75de', '1550684846-86a5d8727436', '1502082553048-f009c305aba5', '1597733336794-12d05021d510', '1549490349-864336237195', '1557683311-eac922347aa1', '1604871000636-074fa5117945', '1557683316-973673baf926', '1519681393797-805402388593', '1518770660439-4636190af475', '1533158681180-0bf58b641e16', '1486718448742-164395e57d5d', '1523961131990-06074deb2923', '1516259762381-22954d7d3ad2', '1528458997752-e82b7101d53c', '1519751138062-acf80f6085c1', '1519750783826-e2420f4d687f', '1513542789411-b6a5d4f31634', '1513151241215-ea9c53a73d52', '1516557070061-c3d1653fa646', '1524169354291-7e244151c7c6', '1528459192924-c09730645cb7', '1515462277126-2dd0c162007a', '1506744038136-46273834b3fb', '1500462918059-b1a0cb512f1d', '1509114397022-ed747cca3f65', '1534224039826-59d880f8f674', '1529641484336-efd99663d298', '1515266591878-5a46b9b72b40', '1562674312-70b99988899b', '1558591718-70148af2fb35', '1550684848-86a5d8727436'],
  Cars: ['1503376763036-066120622c74', '1552519507-da8b1227ad78', '1555215695-99629864d429', '1492144534655-ae79c964c9d7', '1494976388531-d1058494cdd8', '1489824904134-891ab64532f1', '1583121274602-3e2820c698d2', '1533473359331-0135ef1b58bf', '1542282088-fe8426682b8f', '1550751827-4bd374c3f58b', '1568605117036-5fe5e7bab0b7', '1532581140115-3e355d1ed1de', '1511919884226-fd3cad34687c', '1514316454349-750a7fd3da3a', '1535732820272-82a8080d2b5d', '1525609004556-c46c7d6cf023', '1544636331-e26879cd4d9b', '1517362302400-873b4e30f5c0', '1532974297617-c0f035615847', '1535970793442-99d833097ab9', '1541899481282-d53bffe3c35d', '1542362567-b07e54358753', '1541348263637-4384a19aae74', '1519241047957-b8f0555adb71', '1517524206127-48bbd363f3d7', '1526726538654-f92ae38e9d57', '1530906358829-e830dbac08a0', '1519241047957-b8f0555adb71', '1541899481282-d53bffe3c35d', '1542362567-b07e54358753', '1532974297617-c0f035615847', '1535970793442-99d833097ab9', '1544636331-e26879cd4d9b', '1517362302400-873b4e30f5c0', '1535732820272-82a8080d2b5d', '1525609004556-c46c7d6cf023', '1511919884226-fd3cad34687c', '1514316454349-750a7fd3da3a', '1568605117036-5fe5e7bab0b7', '1532581140115-3e355d1ed1de'],
  Mountains: ['1464822759023-fed622ff2c3b', '1465056836041-7f43ac27dcb5', '1486870591958-63224361c02c', '1483086449576-ae55ba48e74f', '1483331562914-7d524823a3d5', '1531685250762-1466d9b8e46b', '1476900966466-d00e78885b52', '1470770841072-f978cf4d019e', '1491553895911-0055eca6402d', '1480497490787-505ec076689f', '1491036775913-3fbc5c455842', '1498855926480-d98e83099315', '1498953153398-333e248039a4', '1499638637986-3d4a390f2959', '1500817306018-c86db0b30034', '1492305175278-c93f9927c3e0', '1493246507139-91e8fad9978e', '1494548162494-384bba4ab999', '1495344517868-8ebaf027795f', '1497215842964-c22022cddda3', '1497436072909-60f360e1d4b0', '1498403011350-13f6305595c9', '1498637841888-2083981a92da', '1501785888041-af3ef285b470', '1502472584811-0a2f2ca429e1', '1502657877623-f66bf4896c38', '1503614472502-021195717355', '1504193907494-4355200ed299', '1504280390367-361c6d9f38f4', '1504608524841-420a4a9a6b72', '1504893524553-b74f0390ea47', '1505765050816-e0469250003e', '1506744038136-46273834b3fb', '1506905925340-98347b43ed56', '1507525428034-b723cf961d3e', '1507781602519-93e252576101', '1508739773245-2b9c9f3e0c03', '1509316975850-ff9c5deb0cd9', '1510784722466-40804027a870', '1513407030348-c983a97b98d8'],
  Ocean: ['1471922694854-ff1b63b20054', '1507525428034-b723cf961d3e', '1582967788607-80d3cd6f5d1e', '1506953823976-52e1fdc0149b', '1560275619-4662e36fa65c', '1534008897354-4c7952eb8c8b', '1505228395891-9a51e7e86bf0', '1513002749550-c59d786b8e6c', '1439405326854-014607f694d7', '1468581356945-600950798833', '1500375599438-0d9e163b3d20', '1518837693464-aa9363227a6a', '1520116468816-95263f1547e2', '1537787009-3ba756d6268d', '1503264116251-35a269479413', '1501426026826-31c667bdf23d', '1505118380757-91f5f6ca5901', '1503756234508-e32369269deb', '1500530855697-b586d89ba3ee', '1480926965639-9b5f63a0817b', '1483683804023-6ccdb62f86ef', '1484291470158-b8f8d608850d', '1489104049669-0428e3aee83c', '1489659639091-8b17c4d17910', '1492970471430-bc872145854b', '1493166306642-99d9b13c39a3', '1494548162494-384bba4ab999', '1495572621020-030a86d25206', '1496737015677-e90f23055501', '1496884723467-391a257827ec', '1497290756760-23ac55edf36f', '1497449493050-aad1e7cad165', '1498931299472-f7a63a02f63a', '1500534623283-312aade485b7', '1500964757637-c85e8a162699', '1501785888041-af3ef285b470', '1502209524164-24280ade7791', '1503198515498-d0bd99577073', '1503433580535-33f7c4587609', '1503614472502-021195717355'],
  Landscapes: ['1472214103451-9374bd1c798e', '1469854523086-cc02fe5d8800', '1476610182048-42097e945c12', '1443632864897-15c52a2455af', '1474044159687-1ee9f3a51722', '1536098561742-ca998e48cbcc', '1482192505345-5655af888cc4', '1499062229216-7c63c9e85f16', '1501785888041-af3ef285b470', '1470770841072-f978cf4d019e', '1475924156734-496f6cac6ec1', '1500534623283-312aade485b7', '1500964757637-c85e8a162699', '1501785888041-af3ef285b470', '1501854140884-074cf2b29792', '1502082553048-f009c305aba5', '1502209524164-24280ade7791', '1502472584811-0a2f2ca429e1', '1502657877623-f66bf4896c38', '1503198515498-d0bd99577073', '1503433580535-33f7c4587609', '1503614472502-021195717355', '1504193907494-4355200ed299', '1504280390367-361c6d9f38f4', '1504608524841-420a4a9a6b72', '1504681869696-d97721183f49', '1504754524776-d388a026e493', '1504893524553-b74f0390ea47', '1505118380757-91f5f6ca5901', '1505228395891-9a51e7e86bf0', '1505765050816-e0469250003e', '1505820013142-f86a3439f5b2', '1506744038136-46273834b3fb', '1506905925340-98347b43ed56', '1507525428034-b723cf961d3e', '1507781602519-93e252576101', '1508739773245-2b9c9f3e0c03', '1509316975850-ff9c5deb0cd9', '1510784722466-40804027a870', '1511289081-d06dda19034d'],
  Fantasy: ['1518531901590-721343eb6b95', '1505506874110-6a7a69069a08', '1487147264018-f937fba0c817', '1500462918059-b1a0cb512f1d', '1511497584788-87a160a33812', '1568255955146-2436d418296a', '1495344517868-8ebaf027795f', '1516541196182-6bdb0516ed27', '1534447677768-be436bb09401', '1519074069444-1ba4fff66d16', '1462331940025-496dfbfc7564', '1515266591878-5a46b9b72b40', '1533293122-19e342894537', '1534972195531-d756b9bfa9f2', '1517411032315-54ef2cb00966', '1512592739343-6d091392df80', '1514944516353-9372bd77063d', '1519681393797-805402388593', '1531306728370-e2ebd9d7bb99', '1541359927-23617131e6dc', '1513542789411-b6a5d4f31634', '1513151241215-ea9c53a73d52', '1516557070061-c3d1653fa646', '1524169354291-7e244151c7c6', '1528459192924-c09730645cb7', '1515462277126-2dd0c162007a', '1506744038136-46273834b3fb', '1500462918059-b1a0cb512f1d', '1509114397022-ed747cca3f65', '1534224039826-59d880f8f674', '1529641484336-efd99663d298', '1515266591878-5a46b9b72b40', '1562674312-70b99988899b', '1558591718-70148af2fb35', '1550684848-86a5d8727436', '1550684847-75994168ede0', '1520690214124-2405c52170f3', '1518331189335-e1b6f007b789', '1504198458649-3128b932f49e', '1470240731273-7821a6eeb6bd'],
  Neon: ['1554188248-986b703899ba', '1565519807-60a54e954543', '1563089145-599997674d42', '1516035069371-29a1b244cc32', '1561484930-998b6a7b516d', '1518640467706-48f522536547', '1553018243-7301c2763294', '1550684848-fac1c5b4e853', '1565214975484-3cfa9e56f914', '1495616811223-4d98c6e9d869', '1535189043414-47a3c49a0bed', '1520034475321-cbe63696469a', '1532298229108-8e61b302795a', '1506443432602-ac2fcd6f54e0', '1531306728370-e2ebd9d7bb99', '1541359927-23617131e6dc', '1542831371-d531d36971e6', '1500462918059-b1a0cb512f1d', '1501862700950-18382cd41497', '1537420327992-d6e1922871a1', '1541701494587-07d2bad30083', '1532375810709-75b1da00537c', '1531604250646-3b814375a7b0', '1537498425277-2276326e469d', '1538370969543-798aaf814603', '1538668523245-f4220e65da81', '1542361345408-24eb727e2760', '1541450805268-4822a3a774ca', '1539651044670-315229da9d2f', '1540914653968-3f539110185c', '1520114878144-6123749968dd', '1499578124509-1611b77778c8', '1503433580535-33f7c4587609', '1533038590840-75deed294509', '1464639487779-165f6f1964a7', '1483701552504-2d525492211c', '1550684847-75994168ede0', '1550684848-fac1c5b4e853', '1515266591878-5a46b9b72b40', '1618005182384-a83a8bd57fbe'],
  Textures: ['1470240731273-7821a6eeb6bd', '1513256087799-a1b66b2803d0', '1520690214124-2405c52170f3', '1550684847-75994168ede0', '1504198458649-3128b932f49e', '1518331189335-e1b6f007b789', '1524334228333-0f6db392f8a1', '1555066931-4365d14bab8c', '1550684848-86a5d8727436', '1505968409364-a74dd0431488', '1510414842594-a61c69b5ae57', '1458245237251-29ec676ae333', '1494438639946-1ebd1d20bf85', '1491147334558-48442d771c31', '1495368383832-6c2e365064db', '1482436423063-f27329977844', '1486718448742-164395e57d5d', '1490919376662-73a7d253f533', '1490237014491-824aee172679', '1484803767222-0d6741162649', '1490100667990-4fced8021649', '1479839672679-a47e30f07f5c', '1500462918059-b1a0cb512f1d', '1496515714798-55df98b0f83c', '1491904762526-16e85e8cefe8', '1507525428034-b723cf961d3e', '1499951360447-b6f6daf84636', '1496247749665-49cf5b1022e9', '1478479405421-ce83c92fb3ba', '1478760329108-5c3ed9d495a0', '1488554378835-f7acf46e6c98', '1494548162494-384bba4ab999', '1497250681960-ef048c0ab947', '1489549132488-d00b7eee80f1', '1497436072909-60f360e1d4b0', '1494236536165-0285b0474148', '1479090793912-eb9929f4fdb2', '1497005367839-6e852de72767', '1488229297570-5852085bb7fa', '1491975474562-1f4e30bc9468'],
  Portrait: ['1534528741775-53994a69daeb', '1531746020798-e6953c6e8e04', '1529626455594-4ff0802cfb7e', '1552374196-c4e7ffc6e526', '1438761681033-6461ffad8d80', '1516035069371-29a1b244cc32', '1485230405346-71acb9518d9c', '1560250097-0b93528c311a', '1506794778202-cad84cf45f1d', '1531123897727-8f129e1688ce', '1517841905240-472988babdf9', '1524504388940-b1c1722653e1', '1524250502761-1ac6f2e30d43', '1530268729831-4b0b9e170218', '1522228119521-51660f89743b', '1513207565459-d9f36bfa1222', '1517462964-21fdcec3f25b', '1513956589380-bad6bac34d9c', '1521119989659-a83faa4885e9', '1520155707818-8274d110cc0e', '1526413232644-8a40f03cc03b', '1520409364224-b340f1d1291d', '1532635241-17e820acc59f', '1529626455594-4ff0802cfb7e', '1522075469751-3a6694fb2f61', '1531123418141-883515667274', '1531427186611-ecfd6d936c79', '1529139574466-a30222ade8ce', '1534528741775-53994a69daeb', '1531746020798-e6953c6e8e04', '1529626455594-4ff0802cfb7e', '1552374196-c4e7ffc6e526', '1438761681033-6461ffad8d80', '1516035069371-29a1b244cc32', '1485230405346-71acb9518d9c', '1560250097-0b93528c311a']
};

export const removeDuplicateWallpapers = (wallpapers: Wallpaper[]): Wallpaper[] => {
  const seenIds = new Set<string>();
  return wallpapers.filter(w => {
    // Extract ID if it's an Unsplash URL, otherwise use the full URL
    const match = w.originalUrl?.match(/photo-([^?]+)/);
    const id = match ? match[1] : (w.originalUrl || w.thumbnailUrl || w.id);
    
    if (seenIds.has(id)) return false;
    seenIds.add(id);
    return true;
  });
};

const generateMockWallpapers = (): Wallpaper[] => {
  const wallpapers: Wallpaper[] = [];
  
  Object.entries(BASE_IMAGES).forEach(([category, ids]) => {
    ids.forEach((id, index) => {
      const imageId = id;
      const wp: Wallpaper = {
        id: `wp-${category}-${index}`,
        title: `${category} Wallpaper ${index + 1}`,
        description: `Beautiful ${category} wallpaper for your desktop and mobile.`,
        thumbnailUrl: `https://images.unsplash.com/photo-${imageId}?auto=format&fit=crop&w=400&q=60`,
        originalUrl: `https://images.unsplash.com/photo-${imageId}?auto=format&fit=crop&w=1920&q=80`,
        resolutions: [
          { type: ResolutionType.UHD, width: 3840, height: 2160, size: '4.2 MB', url: `https://images.unsplash.com/photo-${imageId}?auto=format&fit=crop&w=3840&q=90`, isPremium: true },
          { type: ResolutionType.HD, width: 1920, height: 1080, size: '1.1 MB', url: `https://images.unsplash.com/photo-${imageId}?auto=format&fit=crop&w=1920&q=80` },
          { type: ResolutionType.Mobile, width: 1080, height: 2400, size: '0.8 MB', url: `https://images.unsplash.com/photo-${imageId}?auto=format&fit=crop&w=1080&h=2400&q=80` }
        ],
        uploader: {
          id: 'u-unsplash',
          name: 'Unsplash Photographer',
          avatar: `https://ui-avatars.com/api/?name=${category.charAt(0)}&background=random`
        },
        license: LicenseType.CC0,
        tags: [category.toLowerCase(), 'wallpaper', '4k'],
        category: category,
        views: Math.floor(Math.random() * 50000) + 1000,
        downloads: Math.floor(Math.random() * 10000) + 100,
        createdAt: new Date(Date.now() - Math.random() * 10000000000).toISOString(),
        colors: ['#000000', '#ffffff'],
        aspectRatio: '16:9',
        status: 'published'
      };
      wallpapers.push(wp);
    });
  });
  
  return wallpapers;
};

let MOCK_WALLPAPERS = removeDuplicateWallpapers(generateMockWallpapers());
let MOCK_REPORTS: Report[] = [];

export const WallpaperAPI = {
  getCurrentUser: (): User | null => {
    return currentUser;
  },

  getWallpapers: async (filters: FilterState, page: number = 1, limit: number = 20): Promise<{ wallpapers: Wallpaper[], total: number }> => {
    await new Promise(resolve => setTimeout(resolve, 300)); // Simulate latency
    
    let filtered = MOCK_WALLPAPERS.filter(w => w.status === 'published');

    if (filters.category && filters.category !== 'All') {
      filtered = filtered.filter(w => w.category === filters.category);
    }
    
    if (filters.query) {
      const q = filters.query.toLowerCase();
      filtered = filtered.filter(w => w.title.toLowerCase().includes(q) || w.tags.some(t => t.toLowerCase().includes(q)));
    }

    if (filters.sort === 'popular') {
      filtered.sort((a, b) => b.views - a.views);
    } else if (filters.sort === 'newest') {
      filtered.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());
    } else if (filters.sort === 'trending') {
      filtered.sort((a, b) => b.downloads - a.downloads);
    }

    const start = (page - 1) * limit;
    return {
      wallpapers: filtered.slice(start, start + limit),
      total: filtered.length
    };
  },

  getDownloadUrl: async (id: string, resolution: string): Promise<string> => {
     await new Promise(resolve => setTimeout(resolve, 500));
     const wp = MOCK_WALLPAPERS.find(w => w.id === id);
     if (!wp) throw new Error("Wallpaper not found");
     
     const res = wp.resolutions.find(r => r.type === resolution);
     if (!res) throw new Error("Resolution not found");
     
     if (res.isPremium && !currentUser?.isPremium) {
       throw new Error("Premium subscription required");
     }
     
     return res.url;
  },

  trackDownload: async (id: string, resolution: string): Promise<void> => {
    const wp = MOCK_WALLPAPERS.find(w => w.id === id);
    if (wp) wp.downloads++;
  },

  downloadCustomWallpaper: async (id: string, width: number, height: number, quality: number, format: string): Promise<Blob> => {
    await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate processing
    const wp = MOCK_WALLPAPERS.find(w => w.id === id);
    if (!wp) throw new Error("Wallpaper not found");
    
    // In a real app, this would call an API endpoint that processes the image.
    // Here we just fetch the original image as a blob to simulate a download.
    const response = await fetch(wp.originalUrl);
    const blob = await response.blob();
    return blob;
  },

  reportWallpaper: async (id: string, reason: string): Promise<void> => {
      MOCK_REPORTS.push({
          id: `rep-${Date.now()}`,
          wallpaperId: id,
          reason: reason as any,
          status: 'open',
          createdAt: new Date().toISOString()
      });
  },

  // Moderation
  getModerationQueue: async (): Promise<Wallpaper[]> => {
      return MOCK_WALLPAPERS.filter(w => w.status === 'pending');
  },
  
  getReports: async (): Promise<Report[]> => {
      return MOCK_REPORTS;
  },

  approveWallpaper: async (id: string): Promise<void> => {
      const wp = MOCK_WALLPAPERS.find(w => w.id === id);
      if (wp) wp.status = 'published';
  },

  rejectWallpaper: async (id: string): Promise<void> => {
      const wp = MOCK_WALLPAPERS.find(w => w.id === id);
      if (wp) wp.status = 'rejected';
  },

  uploadWallpaper: async (data: Partial<Wallpaper>): Promise<any> => {
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // Check duplicate image
      const inputUrl = data.originalUrl || data.thumbnailUrl || '';
      const match = inputUrl.match(/photo-([^?]+)/);
      const inputId = match ? match[1] : inputUrl;
      
      const duplicate = MOCK_WALLPAPERS.find(w => {
          const wMatch = w.originalUrl.match(/photo-([^?]+)/);
          const wId = wMatch ? wMatch[1] : w.originalUrl;
          return wId === inputId;
      });

      if (duplicate) {
         return { status: 'duplicate', message: 'Wallpaper already exists', wallpaper: duplicate };
      }

      // Check duplicate title
      const duplicateTitle = MOCK_WALLPAPERS.find(w => w.title.toLowerCase() === data.title?.toLowerCase());
      if (duplicateTitle) return { status: 'duplicate', message: 'Wallpaper with this title already exists' };

      const newWp: Wallpaper = {
        id: `wp-new-${Date.now()}`,
        title: data.title || 'Untitled',
        description: data.description,
        thumbnailUrl: data.thumbnailUrl || '',
        originalUrl: data.originalUrl || '',
        resolutions: [],
        uploader: { id: currentUser?.id || 'u-anon', name: currentUser?.name || 'Anonymous' },
        license: (data.license as LicenseType) || LicenseType.CC0,
        tags: data.tags || [],
        category: data.category || 'Uncategorized',
        views: 0,
        downloads: 0,
        createdAt: new Date().toISOString(),
        colors: [],
        aspectRatio: '16:9',
        status: 'pending', // Pending moderation
        ...data
      } as Wallpaper;
      
      MOCK_WALLPAPERS.unshift(newWp);
      return { status: 'success', wallpaper: newWp };
  }
};

export const AdminAPI = {
    getMediaLibrary: async (): Promise<{ data: Wallpaper[] }> => {
        await new Promise(resolve => setTimeout(resolve, 500));
        return { data: MOCK_WALLPAPERS };
    },

    initUpload: async (files: any[]): Promise<void> => {
        await new Promise(resolve => setTimeout(resolve, 500));
    },

    completeUpload: async (config: UploadFileConfig): Promise<any> => {
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // Add to Mock Database
        const newWp: Wallpaper = {
            id: config.id,
            title: config.metadata.title,
            description: config.metadata.description,
            thumbnailUrl: config.previewUrl,
            originalUrl: config.previewUrl,
            resolutions: [],
            uploader: { id: currentUser?.id || 'u-admin', name: currentUser?.name || 'Admin' },
            license: config.metadata.license,
            tags: config.metadata.tags,
            category: config.metadata.category,
            views: 0,
            downloads: 0,
            createdAt: new Date().toISOString(),
            colors: [],
            aspectRatio: '16:9',
            status: 'published',
            premium: config.metadata.isPremium,
            folder: config.metadata.folder
        } as Wallpaper;
        
        MOCK_WALLPAPERS.unshift(newWp);
        return { status: 'success' };
    }
};
